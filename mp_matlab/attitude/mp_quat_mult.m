function [q] = mp_quat_mult(q1,q2)

q1_0 = q1(1,:);
q1_1 = q1(2,:);
q1_2 = q1(3,:);
q1_3 = q1(4,:);

q2_0 = q2(1,:);
q2_1 = q2(2,:);
q2_2 = q2(3,:);
q2_3 = q2(4,:);

q = zeros(size(q1));
q(1,:) = q1_0.*q2_0-q1_1.*q2_1-q1_2.*q2_2-q1_3.*q2_3;
q(2,:) = q1_0.*q2_1+q1_1.*q2_0+q1_2.*q2_3-q1_3.*q2_2;
q(3,:) = q1_0.*q2_2-q1_1.*q2_3+q1_2.*q2_0+q1_3.*q2_1;
q(4,:) = q1_0.*q2_3+q1_1.*q2_2-q1_2.*q2_1+q1_3.*q2_0;
